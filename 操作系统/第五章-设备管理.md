# 设备管理

## 5.1_1 IO设备的概念和分类

![image-20220829085050701](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208290850913.png)

### 何为I/O设备

![image-20220829085734560](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208290857650.png)

### 分类

#### 1.使用特性

![image-20220829090021339](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208290900540.png)

#### 2.传输速率

![image-20220829090129982](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208290901292.png)

#### 3.信息交换的单位

![image-20220829090335088](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208290903474.png)

### 总结

![image-20220829090440302](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208290904499.png)

## 5.1_2 I/O控制器

![image-20220829090935496](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208290909874.png)

### 机械部件

![image-20220829091048840](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208290910145.png)

### 电子部件(I/O控制器)

> CPU和I/O机械部件之间的`中介`

![image-20220829102539577](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291025717.png)

###  I/O控制器的组成

![image-20220829125212093](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291252279.png)

#### 小细节

![image-20220829125303669](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291253867.png)

##### 内存映像I/O `VS` 寄存器独立编址

![image-20220829130340103](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291303337.png)

### 总结

![image-20220829130627794](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291306031.png)

## 5.1_3 I/O控制方式

![image-20220829131433708](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291314369.png)

### 程序直接控制方式

![image-20220829143757086](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291437474.png)

#### 轮询

> 导致CPU与I/O`串行`

![image-20220829161338015](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291613494.png)



![image-20220829163733380](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291637583.png)

### 中断驱动方式

> CPU与I/O`并行`

![image-20220829164039133](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291640312.png)

![image-20220829164405500](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291644749.png)

### DMA方式

![image-20220829165934927](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291659619.png)

#### DMA控制器

![image-20220829170348147](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291703639.png)

![image-20220829170623871](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291706137.png)

### 通道控制方式

![image-20220829170923614](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291709988.png)

![image-20220829171129397](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291711796.png)

### 总结

> 减少CPU干预频率

![image-20220829171253756](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291712167.png)

## 5.1_4 I/O软件层次结构

![image-20220829172328684](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291723407.png)

### 用户层软件

> 使用`系统调用`

![image-20220829183107002](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291831494.png)

### 设备独立性软件

1. 调用接口

![image-20220829183758631](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291838126.png)

2. 设备保护

![image-20220829183830767](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291838512.png)

3. 差错处理

![image-20220829183934918](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291839776.png)

4. 设备的分配与回收

![image-20220829184019932](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291840828.png)

5. 数据缓冲区管理

![image-20220829184154481](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291841845.png)

6. 建立物理-逻辑设备的映射关系&`LUT`

![image-20220829184405259](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291844714.png)

![image-20220829184625909](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291846476.png)

#### 不同的设备需要不同的设备驱动程序?

- 佳能打印机

![image-20220829191747244](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291917063.png)

- 惠普打印机

![image-20220829191819012](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291918904.png)

> 不同厂家的执行程序不同,因此需要提供对应的驱动程序

![image-20220829191922312](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291919871.png)

### 设备驱动程序

> 不同设备,硬件特性不一,设备驱动方便控制对应的硬件

![image-20220829192113510](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291921720.png)

### 中断处理程序

> 处理顺序依次由
>
> `中断处理`->`设备驱动程序`->`设备独立性软件`->`用户层软件`

![image-20220829192635220](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291926856.png)

### 总结

![image-20220829193203719](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291932844.png)

## 5.1_5 接口

![image-20220829194245995](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291942256.png)

### 输入/输出应用程序接口

![image-20220829195924885](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208291959055.png)

#### 套接字系统调用

![image-20220829200429582](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208292004827.png)

![image-20220829210239035](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208292102549.png)

![image-20220829210411537](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208292104785.png)

### 阻塞I/O以及非阻塞I/O

![image-20220829210740568](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208292107180.png)

### 设备驱动程序接口

![image-20220829211113000](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208292111852.png)

![image-20220829211150157](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208292111712.png)

## 5.2_1 I/O核心子系统

![image-20220829212024812](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208292120091.png)

### 各功能在哪些层次实现

#### I/O调度

![image-20220829212727888](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208292127120.png)

#### 设备保护

> 本质上也是文件保护,关于访问权限的问题

![image-20220829212936895](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208292129504.png)

## 5.2_2 假脱机技术(Spooling)

### 何为脱机技术

![image-20220829213529176](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208292135555.png)

> 批处理,引入了脱机技术(磁带完成)

![image-20220829213724113](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208292137418.png)

### 假脱机技术

> 以软件的方式模拟脱机技术
>
> `输入输出井`充当`磁带`的临时接收数据作用
>
> `输入输出进程`充当`外围控制机`的作用
>
> 必须有`多道程序技术`的支持

![image-20220830065728542](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208300657045.png) 

### 共享打印机原理分析

![image-20220830070318670](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208300703777.png)

![image-20220830070941228](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208300709531.png)

> `虚拟逻辑`,将`独占式设备`改造成`共享设备`

![image-20220830071100409](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208300711454.png)

### 总结

![image-20220830072229938](https://cdn.jsdelivr.net/gh/DZX-hhh/Pictures/images/202208300722991.png)
